<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <title>Document</title>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a href="" class="navbar-brand"><img src="https://www.capfin.co.za/themes/uploads/real-logo3.png"></a>
        <ul class="navbar-nav  mr-auto">
            <li class="nav-item active ">
                <a href="" class="nav-link"><strong>HOME</strong></a>
            </li>
        </ul>
        <div class="navbar-collapse collapse w-100 order-3 dual-collapse2">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <div id="clock" class="navbar-text" style="float: left">
                        <span class="minutes"></span>:
                        <span class="seconds"></span>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container d-flex p-2">
        <div class="row">
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h4 class="card-title">UAT</h4>
                        <canvas id ="UATChartDb"></canvas>
                        <canvas id ="UATChartApp"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h4 class="card-title">PRE</h4>
                        <canvas id ="PREChartDb"></canvas>
                        <canvas id ="PREChartApp"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-body text-center">
                        <h4 class="card-title">SYSTEST</h4>
                        <canvas id ="SYSTESTChartDb"></canvas>
                        <canvas id ="SYSTESTChartApp"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <!-- <div class="frontside">
            <div class="card">
                <div class="card-body text-center">
                    <p><img class=" img-fluid" src="https://sunlimetech.com/portfolio/boot4menu/assets/imgs/team/img_01.png" alt="card image"></p>
                    <h4 class="card-title">Sunlimetech</h4>
                    <p class="card-text">This is basic card with image on top, title, description and button.</p>
                    <a href="#" class="btn btn-primary btn-sm"><i class="fa fa-plus"></i></a>
                </div>
            </div>
        </div> -->
    </div>
    
    <hr color="grey">
     <script>
        let x = 10;
        let color = 'green';
        let myChart = document.getElementById('UATChartDb').getContext('2d');
        let PieChartDb = new Chart(myChart,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title: {
                display: true,
                text: 'DB Restore'
                }
            }
        });
        color = 'green';
        let ChartApp = document.getElementById('UATChartApp').getContext('2d');
        let PieChartApp = new Chart(ChartApp,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title:{
                    display: true,
                    text: 'App Restore'
                }
            }
        });
        x = 10;
        color = 'red';
        let PreChartDb = document.getElementById('PREChartDb').getContext('2d');
        let ChartPreDb = new Chart(PreChartDb,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title: {
                display: true,
                text: 'DB Restore'
                }
            }
        });
        color = 'green';
        let PreChartApp = document.getElementById('PREChartApp').getContext('2d');
        let ChartPreApp = new Chart(PreChartApp,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title:{
                    display: true,
                    text: 'App Restore'
                }
            }
        });
        x = 10;
        color = 'red';
        let SYSTESTChartDb = document.getElementById('SYSTESTChartDb').getContext('2d');
        let ChartSYSTESTDb = new Chart(SYSTESTChartDb,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title: {
                display: true,
                text: 'DB Restore'
                }
            }
        });
        color = 'green';
        let SYSTESTChartApp = document.getElementById('SYSTESTChartApp').getContext('2d');
        let ChartSYSTESTApp = new Chart(SYSTESTChartApp,{
            type: 'pie',
            data: { 
                labels:{
                    display: false
                },
                datasets:[{
                    labels:'UAT',
                    data:[x],
                    backgroundColor: color,
                    borderWidth:1,
                    borderColor:color
                }]
            },
            options:{
                title:{
                    display: true,
                    text: 'App Restore'
                }
            }
        });

        var ColorArray = [
                        'red',
                        'orange',
                        'green'
        ];

        // var CountdownMinutes = 0.125;
        // var CurrentTime = Date.parse(new Date());
        // var DeadLine = new Date(CurrentTime + CountdownMinutes*60*1000);
        // function TimeRemaining(EndTime)
        // {
        //     var timer = Date.parse(EndTime) - Date.parse(new Date());
        //     var seconds = Math.floor((timer/1000) % 60);
        //     var minutes = Math.floor((timer/1000/60) % 60);
        //     var hours = Math.floor((timer/(1000*60*60)) % 24);
        //     var days = Math.floor(timer/(1000*60*60*24));

        //     return {'total':timer, 'days':days, 'hours':hours,'minutes':minutes,'seconds':seconds};
        // }

        // function RunClock(id, EndTime)
        // {
        //     var clock = document.getElementById(id);
        //     function UpdateClock()
        //     {
        //         var time = TimeRemaining(EndTime);
        //         clock.innerHTML = time.minutes+ ':'+ time.seconds;
        //         if (time.total <= 0)
        //         {
        //             clearInterval(TimeInterval);
        //             var RandoIndex = Math.floor(Math.random()*ColorArray.length),
        //             RandoIndex2 = Math.floor(Math.random()*ColorArray.length);

        //             ChartSYSTESTApp.data.datasets[0].backgroundColor = ColorArray[RandoIndex];
        //             ChartSYSTESTApp.data.datasets[0].borderColor = ColorArray[RandoIndex];


        //             ChartSYSTESTDb.data.datasets[0].backgroundColor = ColorArray[RandoIndex2];
        //             ChartSYSTESTDb.data.datasets[0].borderColor = ColorArray[RandoIndex2];




        //             ChartSYSTESTApp.render();
        //             ChartSYSTESTApp.update();
        //             ChartSYSTESTDb.render();
        //             ChartSYSTESTDb.update();
        //         }

        //         if (time.minutes == 0 && time.seconds == 0)
        //         {
        // console.log('in this func');
        //             Deadline = new Date(CurrentTime + CountdownMinutes*60*1000);
        //             RunClock('clock', DeadLine);
        //         }
        //     }

        //     UpdateClock();

        //     var TimeInterval = setInterval(UpdateClock, 1000);
        // }
        // RunClock('clock', DeadLine);

        function getTimeRemaining(endtime) {
        var t = Date.parse(endtime) - Date.parse(new Date());
        var seconds = Math.floor((t / 1000) % 60);
        var minutes = Math.floor((t / 1000 / 60) % 60);
        // var hours = Math.floor((t / (1000 * 60 * 60)) % 24);
        // var days = Math.floor(t / (1000 * 60 * 60 * 24));
        return {
            'total': t,
            // 'days': days,
            // 'hours': hours,
            'minutes': minutes,
            'seconds': seconds
        };
        }

        function initializeClock(id, endtime) {
        var clock = document.getElementById(id);
        // var daysSpan = clock.querySelector('.days');
        // var hoursSpan = clock.querySelector('.hours');
        var minutesSpan = clock.querySelector('.minutes');
        var secondsSpan = clock.querySelector('.seconds');

        function updateClock() {
            var t = getTimeRemaining(endtime);

            // daysSpan.innerHTML = t.days;
            // hoursSpan.innerHTML = ('0' + t.hours).slice(-2);
            minutesSpan.innerHTML = ('0' + t.minutes).slice(-2);
            secondsSpan.innerHTML = ('0' + t.seconds).slice(-2);

            if (t.total <= 0) 
            {
                clearInterval(timeinterval);
                var RandoIndex = Math.floor(Math.random()*ColorArray.length),
                RandoIndex2 = Math.floor(Math.random()*ColorArray.length);

                ChartSYSTESTApp.data.datasets[0].backgroundColor = ColorArray[RandoIndex];
                ChartSYSTESTApp.data.datasets[0].borderColor = ColorArray[RandoIndex];


                ChartSYSTESTDb.data.datasets[0].backgroundColor = ColorArray[RandoIndex2];
                ChartSYSTESTDb.data.datasets[0].borderColor = ColorArray[RandoIndex2];




                ChartSYSTESTApp.render();
                ChartSYSTESTApp.update();
                ChartSYSTESTDb.render();
                ChartSYSTESTDb.update();
            }

            if (t.minutes == 0 && t.seconds == 0) {
            console.log('in this func');
            deadline = new Date(deadline.getTime() + 0.25 * 60000);
            initializeClock('clock', deadline); //added this line
            }
        }

        updateClock();
        var timeinterval = setInterval(updateClock, 1000);
        }

        var deadline = new Date(Date.parse(new Date()) +  0.25 * 60 * 1000);
        initializeClock('clock', deadline);

    </script>
</body>
</html>